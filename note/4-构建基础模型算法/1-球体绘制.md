## 球坐标系

球坐标系（Spherical Coordinate System）是一种常见的三维坐标系，它使用半径、极角和方位角来表示一个点在球面上的位置。球坐标系通常用于描述天体物理学、地球科学、计算机图形学等领域。

![image-20230705163812295](.\image-20230705163812295.png)

球坐标系中的三个坐标分别为：

1. 半径 $r$：表示从原点到点 P 的距离，即点 P 到原点的距离。

2. 极角 $\theta$ （polar angle）（或 $\phi$）：表示从 z 轴正半轴到点 P 的连线与 z 轴正半轴之间的夹角，范围为 $[0, \pi]$。

3. 方位角 $\varphi$ （azimuthal angle）（或 $\theta$）：表示从 x 轴正半轴到点 P 在 xy 平面投影点的连线与 x 轴正半轴之间的夹角，范围为 $[0, 2\pi]$。

**球坐标系与直角坐标系的转换公式如下：(OpenGL)**

$x = r \sin \theta \cos \varphi$

$y = r \sin \theta \sin \varphi$

$z = r \cos \theta$

其中，$\theta$ 和 $\varphi$ 的单位通常为弧度制。可以通过以下方式将直角坐标系的坐标 $(x, y, z)$ 转换为球坐标系的坐标 $(r, \theta, \varphi)$：

$r = \sqrt{x^2 + y^2 + z^2}$

$\theta = \arccos \frac{z}{r}$

$\varphi = \arctan \frac{y}{x}$

**在 DirectX 12 中使用的左手坐标系中，通常将 y 轴指向上方，而 z 轴指向屏幕内部，因此球坐标系转换为直角坐标系的公式应该是：**

$x = r \sin \theta \cos \varphi$

$y = r \cos \theta$

$z = r \sin \theta \sin \varphi$

其中，$\theta$ 的范围是 $[0,\pi]$，$0$ 表示点位于正上方，$\pi$ 表示点位于正下方；$\varphi$ 的范围是 $[0,2\pi]$，表示点相对于 x 轴正半轴的旋转角度。



需要注意的是，当 $x=0$ 时，$\varphi = \frac{\pi}{2}$ 或 $\varphi = -\frac{\pi}{2}$，此时需要特殊处理。

总之，球坐标系提供了一种简单而直观的方法来描述球面上的位置，同时也便于进行坐标变换和计算，应用广泛。