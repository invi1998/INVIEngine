## 四元数求逆公式推导

我们之前得到了一个四元数求逆的公式（**共轭除以模的平方**）
$$
g^{-1} = \frac{g^*}{|g|^2}
$$
首先，我们有如下公式（定理）
$$
gg^{-1}=g^{-1}g=1\\
g=[w, \vec{v}]=w+\vec{v}\\
g^*=[w, -\vec{v}]=w-\vec{v}\\
g_1g_2 = w_1w_2 - \vec{v_1}\cdot\vec{v_2}+w_1\vec{v_2}+w_2\vec{v_1}-\vec{v_1}\times\vec{v_2}\\
gg^* = g^*g= w^2+\vec{v}^2=w^2+x^2+y^2+z^2 = |g|^2
$$
现在来进行证明推导$g^{-1} = \frac{g^*}{|g|^2}$
$$
gg^{-1}=1\\
两边同时乘以g^*\\
g^*gg^{-1}=g^*\\
因为g^*g等于四元数g模的平方，是一个实数，复数（四元数不能除，但是实数可以）,所以就有\\
|g|^2g^{-1}=g^*\\
g^{-1}=\frac{g^*}{|g|^2}
$$


## 四元数对数

在数学中，对数是对求幂的逆运算，正如除法是乘法的逆运算，反之亦然。 这意味着一个数字的对数是必须产生另一个固定数字（基数）的指数。下图是实数的对数图表

![img](.\resize,m_lfit,limit_1,h_1080)

这里回顾一下前面学习复数时的欧拉公式
$$
e^{i\theta}=\cos{\theta}+\sin{\theta}i
$$
对于我们的超复数（四元数）,i部分用v来代替，那这个式子是不是就是如下形式（四元数的欧拉等式）
$$
对于四元数g=[w, \vec{v}]\\
e^{\vec{v}\theta}=w\cos{\theta} + \sin{\theta}\vec{v}\\
一般我们四元数都考虑单位四元数，所以w都为1\\
= \cos{\theta} + \sin{\theta}\vec{v}\\
= \cos{\theta} + \sin{\theta}\vec{v_x}+ \sin{\theta}\vec{v_y}+ \sin{\theta}\vec{v_z}\\
\\写成对数形式\\ \\
\log_e^g=\vec{v}\theta
$$
这样我们就能利用四元数做很多对数计算，比如
$$
\log_e^{g_1g_2} = \log_e^{g_1}+\log_e^{g_2} = \vec{v_1}\theta_1 + \vec{v_2}\theta_2
$$


## 四元数求幂

对于复数来说，我们求一个复数a的n次幂，我们可以利用欧拉公式进行如下计算
$$
a^n = (e^{i\theta})^n = e^{i\theta n} = \cos{\theta}.n + \sin{\theta}.i.n
$$
那推广到超复数（四元数）上来，n个四元数g相乘（g的n次幂）他的结果，也可以利用欧拉公式进行如下计算（这里四元数做了归一化了已经，后续四元数基本也都是再归一化后的基础上进行讨论）(注意这里$\theta = \frac{\theta}{2}$)
$$
g^n = (\cos{\theta} + \sin{\theta}\vec{v})^n\\
= \cos{(\theta n)} + \sin{(\theta n)}\vec{v}\\
= e^{\theta n \vec{v}}\\
\theta = \frac{\theta}{2}\\
g^n = \cos{\frac{\theta}{2}n} + \sin{\frac{\theta}{2}n}\vec{v} = e^{\frac{\theta}{2}n\vec{v}}
$$
我们知道对于常数的幂运算，有如下规则
$$
(a^n)^s = a^{ns}
$$
但是对于四元数，这个规则并不适用
$$
(\vec{g}^n)s \neq (\vec{g})^{ns}
$$




## 纯四元数

$g = [w, \vec{v}]$，单我们的实部w=0的时候，即$g=[0, \vec{v}]$这样的四元数我们称为纯四元数



## 四元数旋转

这里我们先回顾一下复数旋转。我们有两个复数 a，b，他们的角度分别为θ和φ，他们相乘结果如下：
$$
ab = e^{i(\theta+\phi)}
$$
对于两个复数相乘，他的本质其实就是两个角度相加
$$
g_1g_2
$$


![image-20240219143448376](.\image-20240219143448376.png)

同样，对于我们的四元数，也是一样的本质存在，我们将一个四元数乘以另外的一个四元数，也就是将我们的四元数做了一次旋转。但是四元数这样旋转会有什么问题呢？因为四元数w部分的存在，所以导致我们将一个四元数旋转（相乘）的时候，会使得这个四元数在w轴上进行偏移，表现在几何中，就比如我们利用四元数对一个球体进行旋转，旋转之后，会发现这个求不仅旋转了，而且球还变大了。

![image-20240221181719059](.\image-20240221181719059.png)

那如何解决这个问题？我们在旋转的基础上再乘以这个四元数的逆，即最终的旋转公式：
$$
g_1g_2g_1^{-1}\\
其中，这些四元数有如下要求：\\
g_1，g_1^{-1}要是单位四元数（归一化）\\
g_2这个旋转角度四元数要是一个纯四元数
$$


