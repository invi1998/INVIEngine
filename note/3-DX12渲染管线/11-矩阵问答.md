## 透视矩阵中为什么要有-1

在透视投影矩阵中，为了将物体的深度信息映射到2D屏幕上，我们需要使用透视除法（Perspective Division）来将裁剪空间中的坐标变换为归一化设备坐标（Normalized Device Coordinates，简称NDC），即将$x$, $y$和$z$分量分别除以$w$分量：

$$
\begin{aligned}
x_{\text{ndc}} &= x_{\text{clip}}/w_{\text{clip}} \\
y_{\text{ndc}} &= y_{\text{clip}}/w_{\text{clip}} \\
z_{\text{ndc}} &= z_{\text{clip}}/w_{\text{clip}}
\end{aligned}
$$

其中，$x_{\text{clip}}$、$y_{\text{clip}}$、$z_{\text{clip}}$和$w_{\text{clip}}$分别表示裁剪空间中的坐标。在进行透视除法后，NDC坐标的范围是$[-1, 1]$。

为了使透视除法正常工作，我们需要在透视投影矩阵的第四行第三列添加一个$-1$的元素。这是因为透视除法的实现方式是将坐标乘以透视投影矩阵的第四行向量$(0, 0, -1, 0)$的逆，即将第四行第三列设置为$-1$。这样，当执行透视除法时，$w_{\text{clip}}$分量可以通过求解$z_{\text{clip}}$获得，从而得到正确的NDC坐标。

因此，在透视投影矩阵中设置一个$-1$的元素，是为了支持透视除法的实现，以便将3D坐标转换为2D屏幕坐标。